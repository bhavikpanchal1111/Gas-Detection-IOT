<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gas Detection IoT</title>

    <!-- Bootstrap for responsiveness -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        body {
            transition: background-color 0.5s ease;
            text-align: center;
            padding: 2rem;
        }

        h1 {
            color: #000; /* The text color */
            text-shadow: 
                -1px -1px 0 #fff,  /* Top-left outline */
                1px -1px 0 #fff,   /* Top-right outline */
                -1px 1px 0 #fff,   /* Bottom-left outline */
                1px 1px 0 #fff;    /* Bottom-right outline */
        }

        .data-box {
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
            background-color: #f8f9fa;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .data-box:hover {
            transform: scale(1.05);
        }

        .alert {
            font-size: 1.5rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Gas Detection IoT Dashboard</h1>

        <div id="alert-box" class="alert alert-warning" role="alert">
            Loading data...
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="data-box">
                    <h3>Temperature üå°Ô∏è</h3>
                    <p id="temperature">Fetching...</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="data-box">
                    <h3>Gas Level ‚ô®Ô∏è</h3>
                    <p id="gas-level">Fetching...</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="data-box">
                    <h3>Humidity üíß</h3>
                    <p id="humidity">Fetching...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <!-- Custom Scripts -->
    <script>
        // Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDhYvxHPYFveJ8SpV4Lxn7u9h7HymeDVNE",
            authDomain: "gas-detection-iot.firebaseapp.com",
            databaseURL: "https://gas-detection-iot-default-rtdb.firebaseio.com",
            projectId: "gas-detection-iot",
            storageBucket: "gas-detection-iot.appspot.com",
            messagingSenderId: "678488266347",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();

        // Select HTML elements
        const tempElement = document.getElementById("temperature");
        const humidityElement = document.getElementById("humidity");
        const gasLevelElement = document.getElementById("gas-level");
        const alertBox = document.getElementById("alert-box");

        // Threshold value for gas detection
        const GAS_THRESHOLD = 1000;

        // Function to update data on the webpage
        function updateData(temperature, humidity, gasLevel) {
            tempElement.innerText = temperature + " ¬∞C";
            humidityElement.innerText = humidity + " %";
            gasLevelElement.innerText = gasLevel + " ppm";

            if (gasLevel >= GAS_THRESHOLD) {
                document.body.style.backgroundColor = "darkred";
                alertBox.classList.remove("alert-warning");
                alertBox.classList.add("alert-danger");
                alertBox.innerText = "Gas leakage detected! Gas knob is turned off to avoid further leakage!";
            } else {
                document.body.style.backgroundColor = "#f8f9fa";
                alertBox.classList.remove("alert-danger");
                alertBox.classList.add("alert-success");
                alertBox.innerText = "Gas levels are normal. Gas knob is turned on!";
            }
        }

        // Function to fetch data from Firebase
        function fetchData() {
            database.ref("gas_detector").on("value", (snapshot) => {
                const data = snapshot.val();
                const temperature = data.temperature;
                const humidity = data.humidity;
                const gasLevel = data.gas_level;

                updateData(temperature, humidity, gasLevel);
            });
        }

        // Fetch data when the page loads
        window.onload = fetchData;
    </script>
</body>
</html>
